<Window x:Class="AdRev.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:AdRev.Desktop"
        mc:Ignorable="d"
        Title="AdRev" Height="768" Width="1024"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="60" ResizeBorderThickness="5" GlassFrameThickness="0" CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Border Background="#F5F7F9" CornerRadius="10" BorderBrush="#E0E0E0" BorderThickness="1" Margin="0,25,0,25">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Sidebar -->
            <Border Grid.Column="0" Background="White" CornerRadius="10,0,0,10" BorderBrush="#E0E0E0" BorderThickness="0,0,1,0">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Logo -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,40" WindowChrome.IsHitTestVisibleInChrome="True">
                        <materialDesign:PackIcon Kind="Dna" Width="32" Height="32" Foreground="#6366F1" VerticalAlignment="Center"/>
                        <TextBlock Text="AdRev" FontSize="24" FontWeight="Bold" Margin="10,0,0,0" VerticalAlignment="Center" Foreground="#1E293B"/>
                    </StackPanel>

                    <!-- Menu -->
                    <StackPanel Grid.Row="1" WindowChrome.IsHitTestVisibleInChrome="True">
                        <Button x:Name="BtnDashboard" Click="SwitchView_Click" Tag="Dashboard" Style="{StaticResource MaterialDesignFlatButton}" Height="50" HorizontalContentAlignment="Left" Foreground="#6366F1" Background="#EEF2FF" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ViewDashboard" Margin="10,0,15,0"/>
                                <TextBlock Text="Tableau de bord"/>
                            </StackPanel>
                        </Button>
                        
                        <Button x:Name="BtnProjects" Click="SwitchView_Click" Tag="Projects" Style="{StaticResource MaterialDesignFlatButton}" Height="50" HorizontalContentAlignment="Left" Foreground="#64748B" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FolderOpen" Margin="10,0,15,0"/>
                                <TextBlock Text="Liste de projet"/>
                            </StackPanel>
                        </Button>

                        <Button x:Name="BtnAnalysis" Click="SwitchView_Click" Tag="Analysis" Style="{StaticResource MaterialDesignFlatButton}" Height="50" HorizontalContentAlignment="Left" Foreground="#64748B" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ChartBar" Margin="10,0,15,0"/>
                                <TextBlock Text="Analyse rapide"/>
                            </StackPanel>
                        </Button>
                        
                        <Button x:Name="BtnExportFolder" Click="SwitchView_Click" Tag="ExportFolder" Style="{StaticResource MaterialDesignFlatButton}" Height="50" HorizontalContentAlignment="Left" Foreground="#64748B" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FolderUpload" Margin="10,0,15,0"/>
                                <TextBlock Text="Exporter un Dossier"/>
                            </StackPanel>
                        </Button>

                        <Button x:Name="BtnMobileSync" Click="SwitchView_Click" Tag="MobileSync" Style="{StaticResource MaterialDesignFlatButton}" Height="50" HorizontalContentAlignment="Left" Foreground="#64748B" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="CellphoneArrowDown" Margin="10,0,15,0"/>
                                <TextBlock Text="Partage Mobile"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>

                    <!-- User Profile (Clickable to edit) -->
                    <Border Grid.Row="2" Padding="15" Background="#F8FAFC" CornerRadius="8" Cursor="Hand" MouseLeftButtonDown="EditProfile_Click">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="40" Height="40" Fill="#CBD5E1"/>
                            <StackPanel Margin="15,0,0,0" VerticalAlignment="Center">
                                <TextBlock x:Name="UserProfileName" Text="Nouveau Profil" FontWeight="SemiBold" Foreground="#1E293B"/>
                                <TextBlock x:Name="UserProfileTitle" Text="Chercheur" FontSize="12" Foreground="#64748B"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Main Content -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Header -->
                    <RowDefinition Height="*"/>    <!-- Content -->
                </Grid.RowDefinitions>

                <!-- Custom Title Bar / Header -->
                <Grid Grid.Row="0" Height="40" Background="Transparent">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                        <TextBlock x:Name="PageTitle" Text="Tableau de bord" FontSize="18" FontWeight="Medium"/>
                    </StackPanel>

                    <!-- Window Controls and Language Selection -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" WindowChrome.IsHitTestVisibleInChrome="True">
                        <!-- Language Toggles -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,20,0">
                            <Button Content="ðŸ‡«ðŸ‡·" Style="{StaticResource MaterialDesignIconButton}" Width="30" Height="30" Click="ChangeLanguage_Click" Tag="fr" ToolTip="FranÃ§ais"/>
                            <Button Content="ðŸ‡ºðŸ‡¸" Style="{StaticResource MaterialDesignIconButton}" Width="30" Height="30" Click="ChangeLanguage_Click" Tag="en" ToolTip="English"/>
                            <Button Content="ðŸ‡©ðŸ‡ª" Style="{StaticResource MaterialDesignIconButton}" Width="30" Height="30" Click="ChangeLanguage_Click" Tag="de" ToolTip="Deutsch"/>
                            <Button Content="ðŸ‡ªðŸ‡¸" Style="{StaticResource MaterialDesignIconButton}" Width="30" Height="30" Click="ChangeLanguage_Click" Tag="es" ToolTip="EspaÃ±ol"/>
                        </StackPanel>

                        <Button Style="{StaticResource MaterialDesignIconButton}" Width="40" Height="40" Click="Minimize_Click" ToolTip="Minimiser">
                            <materialDesign:PackIcon Kind="WindowMinimize" Width="19" Height="19"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignIconButton}" Width="40" Height="40" Click="Maximize_Click" ToolTip="Maximiser">
                            <materialDesign:PackIcon Kind="WindowMaximize" Width="19" Height="19"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignIconButton}" Width="40" Height="40" Click="Close_Click" ToolTip="Fermer" Foreground="#E74C3C">
                            <materialDesign:PackIcon Kind="WindowClose" Width="19" Height="19"/>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Content Area -->
                <Grid Grid.Row="1">
                    <!-- Dashboard Content -->
                    <ScrollViewer x:Name="DashboardContent" VerticalScrollBarVisibility="Auto" Padding="30" WindowChrome.IsHitTestVisibleInChrome="True">
                        <StackPanel>
                            <!-- Welcome Section -->
                            <Grid Margin="0,0,0,30">
                                <StackPanel>
                                    <TextBlock x:Name="DashboardTitle" Text="Bienvenue sur AdRev" FontSize="32" FontWeight="Bold" Foreground="#1E293B" Margin="0,0,0,10"/>
                                    <TextBlock Text="Voici un aperÃ§u de vos activitÃ©s de recherche rÃ©centes." FontSize="16" Foreground="#64748B"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Button Click="ImportProjectFolder_Click" Content="Importer Dossier" Width="180" Height="45" Background="#10B981" BorderBrush="#10B981" Margin="0,0,10,0"/>
                                    <Button Click="NewProject_Click" Content="Nouveau Projet" Width="180" Height="45" Background="#6366F1" BorderBrush="#6366F1"/>
                                </StackPanel>
                            </Grid>

                            <!-- KPI Cards (Initialized to Zero) -->
                            <UniformGrid Columns="4" Margin="0,0,0,30">
                                <materialDesign:Card Margin="0,0,15,0" Padding="20" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
                                    <StackPanel>
                                        <materialDesign:PackIcon Kind="BriefcaseCheck" Foreground="#6366F1" Width="24" Height="24"/>
                                        <TextBlock x:Name="StatOngoing" Text="0" FontSize="28" FontWeight="Bold" Margin="0,10,0,5"/>
                                        <TextBlock Text="Projets Actifs" Foreground="#64748B"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                <materialDesign:Card Margin="0,0,15,0" Padding="20" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
                                    <StackPanel>
                                        <materialDesign:PackIcon Kind="FileDocumentMultiple" Foreground="#10B981" Width="24" Height="24"/>
                                        <TextBlock x:Name="StatValidated" Text="0" FontSize="28" FontWeight="Bold" Margin="0,10,0,5"/>
                                        <TextBlock Text="Protocoles" Foreground="#64748B"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                <materialDesign:Card Margin="0,0,15,0" Padding="20" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
                                    <StackPanel>
                                        <materialDesign:PackIcon Kind="AccountGroup" Foreground="#F59E0B" Width="24" Height="24"/>
                                        <TextBlock Text="0" FontSize="28" FontWeight="Bold" Margin="0,10,0,5"/>
                                        <TextBlock Text="Collaborateurs" Foreground="#64748B"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                <materialDesign:Card Padding="20" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
                                    <StackPanel>
                                        <materialDesign:PackIcon Kind="ProgressCheck" Foreground="#8B5CF6" Width="24" Height="24"/>
                                        <TextBlock Text="0%" FontSize="28" FontWeight="Bold" Margin="0,10,0,5"/>
                                        <TextBlock Text="Taux de ComplÃ©tion" Foreground="#64748B"/>
                                    </StackPanel>
                                </materialDesign:Card>
                            </UniformGrid>

                            <!-- License Status -->
                            <materialDesign:Card Margin="0,0,0,30" Padding="20" Background="#EEF2FF" materialDesign:ElevationAssist.Elevation="Dp1">
                                <Grid>
                                    <StackPanel>
                                        <TextBlock Text="Licence AdRev ðŸ”‘" FontSize="18" FontWeight="Bold" Foreground="#6366F1"/>
                                        <TextBlock x:Name="LicenseStatusText" Text="Chargement..." FontSize="12" Foreground="#64748B"/>
                                    </StackPanel>
                                    <Button x:Name="BtnUpgrade" HorizontalAlignment="Right" VerticalAlignment="Center" Content="UPGRADE" Click="OpenUpgrade_Click" Visibility="Collapsed" Background="#F59E0B" BorderBrush="#F59E0B"/>
                                    <Button HorizontalAlignment="Right" VerticalAlignment="Center" Content="GÃ©rer" Margin="0,0,100,0" Click="OpenActivation_Click" Style="{StaticResource MaterialDesignOutlinedButton}"/>
                                </Grid>
                            </materialDesign:Card>

                            <!-- Recent Projects -->
                            <TextBlock Text="Projets rÃ©cents" FontSize="18" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,15"/>
                            
                            <materialDesign:Card materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
                                <DataGrid x:Name="RecentProjectsDataGrid" ItemsSource="{Binding RecentProjects}" AutoGenerateColumns="False" CanUserAddRows="False" HeadersVisibility="All" Background="White" BorderThickness="0" Padding="10">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Nom du projet" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="150"/>
                                        <DataGridTextColumn Header="Statut" Binding="{Binding Status}" Width="120"/>
                                        <DataGridTextColumn Header="DerniÃ¨re modification" Binding="{Binding LastModified, StringFormat='dd/MM/yyyy HH:mm'}" Width="180"/>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Click="OpenProject_Click" Style="{StaticResource MaterialDesignFlatButton}" Content="Ouvrir" Foreground="#6366F1"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </materialDesign:Card>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Dynamic Content -->
                    <ContentControl x:Name="ActiveViewContent" Visibility="Collapsed" WindowChrome.IsHitTestVisibleInChrome="True"/>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
