<Window x:Class="AdRev.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AdRev.Desktop"
        mc:Ignorable="d"
        Title="AdRev - Science Suite" Height="750" Width="1200"
        MinHeight="650" MinWidth="1024"
        WindowStartupLocation="Manual"
        Closing="Window_Closing"
        Icon="pack://application:,,,/AdRev.Desktop;component/Assets/AppIcon.png"
        Background="{StaticResource BackgroundBrush}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" ResizeBorderThickness="8" CornerRadius="0" GlassFrameThickness="0"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <!-- Resources moved to App.xaml -->
    </Window.Resources>
    
    <!-- Main Window Border (The Frame) -->
    <Border BorderBrush="{StaticResource PrimaryDarkBrush}" BorderThickness="1">
    <Grid>
        <!-- Background Logo Watermark -->
        <Grid.Background>
            <VisualBrush Opacity="0.12" Stretch="None" AlignmentX="Center" AlignmentY="Center">
                <VisualBrush.Visual>
                    <Grid Width="400" Height="400">
                        <Viewbox Width="400" Height="400">
                            <TextBlock Text="AdRev" 
                                      FontSize="120" 
                                      FontWeight="Black"
                                      Foreground="{StaticResource PrimaryBrush}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      RenderTransformOrigin="0.5,0.5">
                                <TextBlock.RenderTransform>
                                    <RotateTransform Angle="-45"/>
                                </TextBlock.RenderTransform>
                            </TextBlock>
                        </Viewbox>
                    </Grid>
                </VisualBrush.Visual>
            </VisualBrush>
        </Grid.Background>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Title Bar / Tabs -->
            <RowDefinition Height="Auto"/> <!-- Ribbon Commands -->
            <RowDefinition Height="*"/>    <!-- Content -->
            <RowDefinition Height="25"/>   <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- 1. TOP RIBBON TABS -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryDarkBrush}" Padding="10,5,10,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/> <!-- Window Controls -->
                </Grid.ColumnDefinitions>
                
                <!-- Quick Access Toolbar + Title -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,30,5" WindowChrome.IsHitTestVisibleInChrome="True">
                     <TextBlock Text="AdRev" Foreground="White" FontSize="18" FontWeight="Black" VerticalAlignment="Center" Margin="0,0,15,0"/>
                     
                     <Button Content="&#xE74E;" Click="QuickSave_Click" ToolTip="Enregistrer" Background="Transparent" Foreground="#E0E0E0" BorderThickness="0" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,5,0" Padding="5"/>
                     <Button Content="&#xE8E5;" Click="QuickOpen_Click" ToolTip="Ouvrir" Background="Transparent" Foreground="#E0E0E0" BorderThickness="0" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,5,0" Padding="5"/>
                     <Button Content="&#xE72D;" Click="QuickShare_Click" ToolTip="Partager" Background="Transparent" Foreground="#E0E0E0" BorderThickness="0" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,5,0" Padding="5"/>
                </StackPanel>
                
                <!-- Tabs -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                    <RadioButton x:Name="RibbonFile" Style="{StaticResource RibbonTabButtonStyle}" Content="Fichier" IsChecked="True" Checked="Ribbon_Checked"/>
                    <RadioButton x:Name="RibbonHelp" Style="{StaticResource RibbonTabButtonStyle}" Content="Aide" Checked="Ribbon_Checked"/>
                </StackPanel>

                <!-- Window Control Buttons (Top Right) -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Top" Margin="0,-5,-10,0">
                    <Button Style="{StaticResource WindowControlButtonStyle}" Content="&#xE921;" Click="Minimize_Click" ToolTip="RÃ©duire"/>
                    <Button Style="{StaticResource WindowControlButtonStyle}" Content="&#xE922;" Click="Maximize_Click" ToolTip="Agrandir/Restaurer"/>
                    <Button Style="{StaticResource CloseButtonStyle}" Content="&#xE8BB;" Click="Close_Click" ToolTip="Fermer"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 2. RIBBON COMMANDS PANEL -->
        <Border Grid.Row="1" Background="{StaticResource MenuBarBrush}" BorderBrush="#DDD" BorderThickness="0,0,0,1" Padding="12,5">
            <Grid Height="50">
                <!-- Group: FILE -->
                <StackPanel Orientation="Horizontal" Visibility="{Binding IsChecked, ElementName=RibbonFile, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="TabHome_Click">
                        <Button.Resources>
                            <TextBlock x:Key="Icon" Text="&#xE80F;" FontFamily="Segoe MDL2 Assets" FontSize="20"/>
                        </Button.Resources>
                        <TextBlock Text="Accueil"/>
                    </Button>
                    <Button x:Name="BtnNewProject" Style="{StaticResource RibbonActionButtonStyle}" Click="TabNewProject_Click">
                        <Button.Resources>
                            <TextBlock x:Key="Icon" Text="&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="20"/>
                        </Button.Resources>
                        <TextBlock Text="Nouveau Projet"/>
                    </Button>
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="OpenTeamWindow_Click">
                        <Button.Resources>
                            <TextBlock x:Key="Icon" Text="ðŸ‘¥" FontSize="20"/>
                        </Button.Resources>
                        <TextBlock Text="Ã‰quipe"/>
                    </Button>
                    <Border BorderBrush="#EEE" BorderThickness="1,0,0,0" Margin="10,5"/>
                    <Button x:Name="BtnCloudSync" Style="{StaticResource RibbonActionButtonStyle}" ToolTip="Partager ce projet sur le rÃ©seau">
                        <Button.Resources>
                            <TextBlock x:Key="Icon" Text="â˜ï¸" FontSize="20"/>
                        </Button.Resources>
                        <TextBlock Text="Partager"/>
                    </Button>
                </StackPanel>


                <!-- Group: HELP -->
                <StackPanel Orientation="Horizontal" Visibility="{Binding IsChecked, ElementName=RibbonHelp, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="HelpAction_Click" Tag="Documentation">
                        <StackPanel>
                            <TextBlock Text="&#xE897;" FontFamily="Segoe MDL2 Assets" FontSize="18" HorizontalAlignment="Center"/>
                            <TextBlock Text="Documentation" FontSize="11" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="HelpAction_Click" Tag="Support">
                        <StackPanel>
                            <TextBlock Text="&#xE8F2;" FontFamily="Segoe MDL2 Assets" FontSize="18" HorizontalAlignment="Center"/>
                            <TextBlock Text="Support" FontSize="11" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="HelpAction_Click" Tag="About">
                        <StackPanel>
                            <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="18" HorizontalAlignment="Center"/>
                            <TextBlock Text="Ã€ propos" FontSize="11" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource RibbonActionButtonStyle}" Click="OpenProfile_Click">
                        <StackPanel>
                            <TextBlock Text="ðŸ‘¤" FontSize="18" HorizontalAlignment="Center"/>
                            <TextBlock Text="Mon Profil" FontSize="11" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 3. MAIN CONTENT AREA -->
        <TabControl x:Name="MainViewTabControl" Grid.Row="2" Background="Transparent" BorderThickness="0" Margin="0,-1,0,0">
            <TabControl.Template>
                <ControlTemplate TargetType="TabControl">
                    <ContentPresenter ContentSource="SelectedContent" />
                </ControlTemplate>
            </TabControl.Template>

            <!-- Accueil / Dashboard -->
            <TabItem x:Name="ViewDash">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="30" Background="#F5F7F8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Dashboard Header Banner -->
                         <Border Grid.Row="0" Height="120" CornerRadius="10" Margin="0,0,0,15" ClipToBounds="True">
                             <Grid>
                                 <Image Source="pack://application:,,,/AdRev.Desktop;component/Assets/BannerIcon.png" Stretch="UniformToFill" Opacity="0.5"/>
                                 <Border Background="#2C3E50" Opacity="0.3"/>
                                 
                                 <!-- Linear Gradient Overlay for Readability -->
                                 <Border>
                                     <Border.Background>
                                         <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                             <GradientStop Color="#CC455A64" Offset="0.0"/>
                                             <GradientStop Color="#00455A64" Offset="0.7"/>
                                         </LinearGradientBrush>
                                     </Border.Background>
                                 </Border>
                                 
                                 <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="30,0">
                                    <!-- App Icon Prominent -->
                                    <!-- App Icon Prominent -->
                                     <Border Width="90" Height="90" CornerRadius="45" Background="White" BorderBrush="#29B6F6" BorderThickness="4" Margin="0,0,20,0">
                                         <Border.Effect>
                                             <DropShadowEffect BlurRadius="10" Color="#222" Opacity="0.3" ShadowDepth="3"/>
                                         </Border.Effect>
                                         <Image Source="pack://application:,,,/AdRev.Desktop;component/Assets/BannerIcon.png" Width="60" Height="60" HorizontalAlignment="Center" VerticalAlignment="Center" RenderOptions.BitmapScalingMode="HighQuality"/>
                                     </Border>

                                     <StackPanel VerticalAlignment="Center">
                                        <TextBlock x:Name="DashboardTitle" Text="Tableau de Bord Scientifique" FontSize="28" FontWeight="Bold" Foreground="White">
                                             <TextBlock.Effect>
                                                 <DropShadowEffect BlurRadius="5" Color="#333" Opacity="0.3" ShadowDepth="1"/>
                                             </TextBlock.Effect>
                                         </TextBlock>
                                         <TextBlock Text="Vue d'ensemble de vos recherches et analyses" FontSize="14" Foreground="#ECEFF1"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Grid>
                         </Border>

                         <!-- Action Row: Description & Connect/RBAC -->
                         <Grid Grid.Row="1" Margin="5,0,5,25">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="320"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel VerticalAlignment="Center" Margin="0,0,20,0">
                                <TextBlock Text="AdRev Platform : Votre environnement de recherche" FontSize="18" FontWeight="Bold" Foreground="#444" Margin="0,0,0,10"/>
                                <TextBlock Text="AdRev est votre plateforme intÃ©grÃ©e pour la recherche scientifique : conception de protocoles, gestion de donnÃ©es et analyses statistiques automatisÃ©es. Optimisez votre flux de travail scientifique en Ã©quipe." 
                                           FontSize="14" Foreground="#78909C" TextWrapping="Wrap" FontStyle="Italic"/>
                            </StackPanel>

                            <Border Grid.Column="1" Background="#EEF2F5" CornerRadius="12" Padding="20">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="15" Color="#CFD8DC" Opacity="0.4" ShadowDepth="4"/>
                                </Border.Effect>
                                <StackPanel>
                                    <!-- License Section -->
                                    <Grid Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="Licence AdRev ðŸ”‘" FontSize="18" FontWeight="Bold" Foreground="#7C4DFF"/>
                                            <TextBlock x:Name="LicenseStatusText" Text="Chargement..." FontSize="11" Foreground="#546E7A"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button x:Name="BtnUpgrade" Content="ðŸš€ UPGRADE" Click="OpenUpgrade_Click" Visibility="Collapsed" Background="#FFD700" Foreground="Black" FontWeight="Bold" FontSize="10" Padding="5,2" Margin="0,0,5,0" Cursor="Hand" ToolTip="Passer Ã  une version supÃ©rieure"/>
                                            <Button Content="âš™ï¸" Click="OpenActivation_Click" VerticalAlignment="Top" Background="Transparent" BorderThickness="0" ToolTip="GÃ©rer la licence"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <Rectangle Height="1" Fill="#CBD5E0" Margin="0,5,0,15"/>

                                    <Grid Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="AdRev Connect ðŸŒ" FontSize="18" FontWeight="Bold" Foreground="#3F51B5"/>
                                            <TextBlock Text="Projets partagÃ©s" FontSize="11" Foreground="#546E7A"/>
                                        </StackPanel>
                                        <Border x:Name="StatusDot" HorizontalAlignment="Right" VerticalAlignment="Center" Width="10" Height="10" CornerRadius="5" Background="Gray"/>
                                    </Grid>

                                    <StackPanel x:Name="ServerLoginPanel">
                                        <TextBlock Text="Serveur / IP :" FontSize="11" Foreground="#546E7A" Margin="0,0,0,3"/>
                                        <TextBox x:Name="ServerUrlBox" Text="https://cloud.adrev.org" Padding="8" Margin="0,0,0,10" ToolTip="URL du serveur AdRev" 
                                                 Tag="Ex: https://cloud.adrev.org"
                                                 Background="White" Foreground="Black" BorderBrush="#3F51B5" BorderThickness="1.5"/>
                                        <Button Content="Connexion RÃ©seau" Style="{StaticResource ModernButtonStyle}" Height="35" FontSize="13"/>
                                    </StackPanel>

                                    <StackPanel x:Name="NetworkActivePanel" Visibility="Collapsed">
                                        <TextBlock Text="ConnectÃ©" FontWeight="Bold" Foreground="#2E7D32" FontSize="12"/>
                                        <TextBlock x:Name="NetworkDetailText" Text="Serveur : cloud.adrev.org" FontSize="10" Foreground="#546E7A" Margin="0,2,0,10"/>
                                         <Button Content="DÃ©connecter" Style="{StaticResource ModernButtonStyle}" Background="#E53935" Foreground="White" Padding="10,5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#CBD5E0" Margin="0,15"/>

                                    <!-- Collaboration Space -->
                                    <TextBlock Text="Collaboration Live" FontSize="11" FontWeight="Bold" Foreground="#37474F" Margin="0,0,0,8"/>
                                    <UniformGrid Columns="3" Margin="0,0,0,15">
                                        <Button ToolTip="RÃ©union Zoom" Background="#2D8CFF" BorderThickness="0" Padding="5" Margin="2" Tag="Zoom">
                                            <TextBlock Text="Z" FontWeight="Bold" Foreground="White" FontSize="14"/>
                                        </Button>
                                        <Button ToolTip="Microsoft Teams" Background="#6264A7" BorderThickness="0" Padding="5" Margin="2" Tag="Teams">
                                            <TextBlock Text="T" FontWeight="Bold" Foreground="White" FontSize="14"/>
                                        </Button>
                                        <Button ToolTip="Cisco Webex" Background="#000000" BorderThickness="0" Padding="5" Margin="2" Tag="Webex">
                                            <TextBlock Text="W" FontWeight="Bold" Foreground="White" FontSize="14"/>
                                        </Button>
                                    </UniformGrid>
                                    
                                    <!-- Collaboration tools only -->
                                </StackPanel>
                            </Border>
                         </Grid>
 
                         <!-- NEW: Version Information & Highlights -->
                         <Border Grid.Row="2" Background="White" CornerRadius="12" Padding="20" Margin="5,0,5,25" BorderBrush="#E0E0E0" BorderThickness="1">
                             <Border.Effect>
                                 <DropShadowEffect BlurRadius="12" Color="#DDD" Opacity="0.4" ShadowDepth="2"/>
                             </Border.Effect>
                             <StackPanel>
                                 <Grid>
                                     <TextBlock Text="NouveautÃ©s de la Version 1.0 (Ã‰dition Initiale)" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,15"/>
                                     <Border HorizontalAlignment="Right" VerticalAlignment="Top" Background="#E3F2FD" CornerRadius="4" Padding="8,2" Margin="0,-5,0,0">
                                         <TextBlock Text="FIRST EDITION" FontSize="10" FontWeight="Bold" Foreground="#1565C0"/>
                                     </Border>
                                 </Grid>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     
                                     <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                         <TextBlock Text="âœ¨ Protocole Intelligent" FontWeight="Bold" Foreground="#444" Margin="0,0,0,5"/>
                                         <TextBlock Text="Migration complÃ¨te du module de protocole avec validation Bloom et calculatrices intÃ©grÃ©es." FontSize="11" Foreground="#666" TextWrapping="Wrap"/>
                                     </StackPanel>
                                     
                                     <StackPanel Grid.Column="1" Margin="0,0,15,0">
                                         <TextBlock Text="ðŸ“š Aide Intuitive" FontWeight="Bold" Foreground="#444" Margin="0,0,0,5"/>
                                         <TextBlock Text="Centre d'aide interactif avec guides visuels pour chaque Ã©tape de votre recherche." FontSize="11" Foreground="#666" TextWrapping="Wrap"/>
                                     </StackPanel>
                                     
                                     <StackPanel Grid.Column="2">
                                         <TextBlock Text="ðŸš€ Performance &amp; StabilitÃ©" FontWeight="Bold" Foreground="#444" Margin="0,0,0,5"/>
                                         <TextBlock Text="Architecture optimisÃ©e pour Windows 11 et exportations Word ultra-rapides." FontSize="11" Foreground="#666" TextWrapping="Wrap"/>
                                     </StackPanel>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Stats & Actions Row -->
                         <Grid Grid.Row="3" Margin="0,0,0,30">
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="*"/>
                                 <ColumnDefinition Width="*"/>
                                 <ColumnDefinition Width="1.2*"/>
                                 <ColumnDefinition Width="1.2*"/>
                             </Grid.ColumnDefinitions>
                             
                            <!-- Stat 1: Ongoing Projects with Mini Chart -->
                            <Border Grid.Column="0" Background="White" CornerRadius="12" Padding="20" Margin="0,0,15,0">
                                <Border.RenderTransform>
                                    <TranslateTransform Y="20"/>
                                </Border.RenderTransform>
                                <Border.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" From="20" To="0" Duration="0:0:0.5" DecelerationRatio="0.5"/>
                                                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.5"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Border.Triggers>
                                <Border.Effect><DropShadowEffect BlurRadius="15" Color="#CFD8DC" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                <Grid>
                                    <StackPanel>
                                        <TextBlock Text="Projets En Cours" FontSize="15" FontWeight="SemiBold" Foreground="#78909C" Margin="0,0,0,10"/>
                                        <TextBlock x:Name="StatOngoing" Text="0" FontSize="42" FontWeight="Bold" Foreground="#3F51B5"/>
                                        <TextBlock Text="Actifs" FontSize="12" Foreground="#9FA8DA" Margin="2,0,0,0"/>
                                    </StackPanel>
                                    
                                    <!-- Pseudo Chart -->
                                    <Canvas Width="60" Height="40" HorizontalAlignment="Right" VerticalAlignment="Bottom" Opacity="0.8">
                                        <Polyline Points="0,40 10,25 20,30 30,10 40,20 50,5 60,0" Stroke="#3F51B5" StrokeThickness="2"/>
                                        <Polygon Points="0,40 10,25 20,30 30,10 40,20 50,5 60,0 60,40" Fill="#E8EAF6" Opacity="0.5"/>
                                        <Ellipse Width="6" Height="6" Fill="#3F51B5" Canvas.Left="57" Canvas.Top="-3"/>
                                    </Canvas>
                                </Grid>
                            </Border>

                            <!-- Stat 2: Validated Protocols with Success Ring -->
                            <Border Grid.Column="1" Background="White" CornerRadius="12" Padding="20" Margin="0,0,15,0">
                                <Border.Effect><DropShadowEffect BlurRadius="15" Color="#CFD8DC" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                <Grid>
                                    <StackPanel>
                                        <TextBlock Text="Protocoles ValidÃ©s" FontSize="15" FontWeight="SemiBold" Foreground="#78909C" Margin="0,0,0,10"/>
                                        <TextBlock x:Name="StatValidated" Text="0" FontSize="42" FontWeight="Bold" Foreground="#43A047"/>
                                        <TextBlock Text="TerminÃ©s" FontSize="12" Foreground="#A5D6A7" Margin="2,0,0,0"/>
                                    </StackPanel>
                                    
                                     <!-- Pseudo Donut Chart -->
                                     <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="50" Height="50" Opacity="0.9">
                                         <Ellipse Width="50" Height="50" Stroke="#E8F5E9" StrokeThickness="5"/>
                                         <Path Data="M 25,0 A 25,25 0 0 1 50,25" Stroke="#43A047" StrokeThickness="5" StrokeStartLineCap="Round" StrokeEndLineCap="Round" Margin="0,0,0,0"/>
                                         <TextBlock Text="%" FontSize="10" FontWeight="Bold" Foreground="#43A047" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                     </Grid>
                                </Grid>
                            </Border>
                             
                             <!-- Action Card: Import -->
                                    <Button Grid.Column="2" Background="White" BorderThickness="0" Cursor="Hand" Margin="0,0,15,0">
                                 <Button.Template>
                                     <ControlTemplate TargetType="Button">
                                         <Border Background="White" CornerRadius="10" BorderBrush="#2196F3" BorderThickness="1" Padding="15">
                                             <Border.Effect><DropShadowEffect BlurRadius="10" Color="#DDD" Opacity="0.3"/></Border.Effect>
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="Auto"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 <Border Background="#E3F2FD" Width="50" Height="50" CornerRadius="25" Margin="0,0,15,0">
                                                     <TextBlock Text="ðŸ“Š" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                 </Border>
                                                 <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                     <TextBlock Text="Analyse Rapide" FontWeight="Bold" FontSize="16" Foreground="#1565C0"/>
                                                     <TextBlock Text="Importer une base de donnÃ©es CSV/Excel pour des tests immÃ©diats." FontSize="11" Foreground="#777" TextWrapping="Wrap"/>
                                                 </StackPanel>
                                             </Grid>
                                         </Border>
                                     </ControlTemplate>
                                 </Button.Template>
                             </Button>

                            <!-- NEW: Import Folder Card -->
                            <Button Grid.Column="3" Click="ImportProjectFolder_Click" Background="White" BorderThickness="0" Cursor="Hand">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="White" CornerRadius="10" BorderBrush="#4CAF50" BorderThickness="1" Padding="15">
                                            <Border.Effect><DropShadowEffect BlurRadius="10" Color="#DDD" Opacity="0.3"/></Border.Effect>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Border Background="#E8F5E9" Width="50" Height="50" CornerRadius="25" Margin="0,0,15,0">
                                                    <TextBlock Text="ðŸ“‚" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="Importer Dossier" FontWeight="Bold" FontSize="16" Foreground="#2E7D32"/>
                                                    <TextBlock Text="Charger un dossier de recherche existant depuis le PC." FontSize="11" Foreground="#777" TextWrapping="Wrap"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button> 

                         </Grid>
                        <!-- Projects Section -->
                        <StackPanel Grid.Row="3">
                             
                             <!-- Section Title & Action -->
                             <Grid Grid.Row="0" Margin="0,0,0,15">
                                 <TextBlock Text="VOS PROJETS RÃ‰CENTS" FontSize="16" FontWeight="Bold" Foreground="#555" VerticalAlignment="Center"/>
                                 <Button HorizontalAlignment="Right" Click="TabNewProject_Click" Background="#2196F3" Foreground="White" BorderThickness="0" Padding="15,8" Cursor="Hand">
                                     <Button.Resources>
                                         <Style TargetType="Border">
                                             <Setter Property="CornerRadius" Value="20"/>
                                         </Style>
                                     </Button.Resources>
                                     <StackPanel Orientation="Horizontal">
                                         <TextBlock Text="+" Margin="0,0,5,0" FontWeight="Bold"/>
                                         <TextBlock Text="Nouveau Projet"/>
                                     </StackPanel>
                                 </Button>
                             </Grid>

                             <!-- LIST: TEAM Projects -->
                             <TextBlock Text="PROJETS D'Ã‰QUIPE" FontSize="14" FontWeight="Bold" Foreground="#7986CB" Margin="0,0,0,10"/>
                             <ItemsControl x:Name="ProjectsListTeam" Grid.Row="1" Margin="0,0,0,25">
                                 <ItemsControl.ItemsPanel>
                                     <ItemsPanelTemplate>
                                         <WrapPanel/>
                                     </ItemsPanelTemplate>
                                 </ItemsControl.ItemsPanel>
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Button Click="OpenProject_Click" Tag="{Binding}" Background="Transparent" BorderThickness="0" Margin="0,0,20,20" Cursor="Hand">
                                             <Button.Template>
                                                 <ControlTemplate TargetType="Button">
                                                     <Border Background="White" CornerRadius="12" Width="280" Height="160" BorderBrush="#E8EAF6" BorderThickness="1">
                                                         <Border.Effect>
                                                             <DropShadowEffect BlurRadius="15" Color="#C5CAE9" Opacity="0.4" ShadowDepth="3"/>
                                                         </Border.Effect>
                                                         <Grid>
                                                             <Grid.RowDefinitions>
                                                                 <RowDefinition Height="*"/>
                                                                 <RowDefinition Height="Auto"/>
                                                             </Grid.RowDefinitions>
                                                             
                                                             <!-- Color Strip -->
                                                             <Border Grid.Row="0" CornerRadius="12,12,0,0" Background="#E8EAF6" Padding="20">
                                                                 <StackPanel>
                                                                     <Border Background="#3F51B5" HorizontalAlignment="Left" CornerRadius="4" Padding="8,4" Margin="0,0,0,10">
                                                                         <TextBlock Text="Ã‰QUIPE" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                                                     </Border>
                                                                     <TextBlock Text="{Binding Title}" FontSize="16" FontWeight="Bold" TextWrapping="Wrap" MaxHeight="60" TextTrimming="CharacterEllipsis"/>
                                                                     <TextBlock Text="{Binding StudyType}" FontSize="12" Foreground="#7986CB" Margin="0,5,0,0"/>
                                                                 </StackPanel>
                                                             </Border>
                                                             
                                                             <!-- Footer -->
                                                             <Border Grid.Row="1" Padding="15,10" BorderBrush="#FAFAFA" BorderThickness="0,1,0,0">
                                                                  <Grid>
                                                                      <TextBlock Text="{Binding CreatedOn, StringFormat='CrÃ©Ã© le {0:dd/MM/yyyy}'}" FontSize="11" Foreground="#AAA" VerticalAlignment="Center"/>
                                                                      <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                                          <TextBlock Text="ðŸ‘¥" Foreground="#7986CB" Margin="0,0,5,0"/>
                                                                      </StackPanel>
                                                                  </Grid>
                                                             </Border>
                                                         </Grid>
                                                     </Border>
                                                 </ControlTemplate>
                                             </Button.Template>
                                         </Button>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>

                             <!-- LIST: INDIVIDUAL Projects -->
                             <TextBlock Text="PROJETS PERSONNELS" FontSize="14" FontWeight="Bold" Foreground="#90A4AE" Margin="0,0,0,10"/>
                             <ItemsControl x:Name="ProjectsListIndividual" Grid.Row="1" Margin="0,0,0,30">
                                 <ItemsControl.ItemsPanel>
                                     <ItemsPanelTemplate>
                                         <WrapPanel/>
                                     </ItemsPanelTemplate>
                                 </ItemsControl.ItemsPanel>
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Button Click="OpenProject_Click" Tag="{Binding}" Background="Transparent" BorderThickness="0" Margin="0,0,20,20" Cursor="Hand">
                                             <Button.Template>
                                                 <ControlTemplate TargetType="Button">
                                                     <Border Background="White" CornerRadius="12" Width="280" Height="160" BorderBrush="#EEE" BorderThickness="1">
                                                         <Border.Effect>
                                                             <DropShadowEffect BlurRadius="15" Color="#DDD" Opacity="0.4" ShadowDepth="3"/>
                                                         </Border.Effect>
                                                         <Grid>
                                                             <Grid.RowDefinitions>
                                                                 <RowDefinition Height="*"/>
                                                                 <RowDefinition Height="Auto"/>
                                                             </Grid.RowDefinitions>
                                                             
                                                             <!-- Color Strip -->
                                                             <Border Grid.Row="0" CornerRadius="12,12,0,0" Background="#F8F9FA" Padding="20">
                                                                 <StackPanel>
                                                                     <Border Background="#E0E0E0" HorizontalAlignment="Left" CornerRadius="4" Padding="8,4" Margin="0,0,0,10">
                                                                         <TextBlock Text="PERSONNEL" FontSize="10" FontWeight="Bold" Foreground="#757575"/>
                                                                     </Border>
                                                                     <TextBlock Text="{Binding Title}" FontSize="16" FontWeight="Bold" TextWrapping="Wrap" MaxHeight="60" TextTrimming="CharacterEllipsis"/>
                                                                     <TextBlock Text="{Binding StudyType}" FontSize="12" Foreground="#888" Margin="0,5,0,0"/>
                                                                 </StackPanel>
                                                             </Border>
                                                             
                                                             <!-- Footer -->
                                                             <Border Grid.Row="1" Padding="15,10" BorderBrush="#FAFAFA" BorderThickness="0,1,0,0">
                                                                  <Grid>
                                                                      <TextBlock Text="{Binding CreatedOn, StringFormat='CrÃ©Ã© le {0:dd/MM/yyyy}'}" FontSize="11" Foreground="#AAA" VerticalAlignment="Center"/>
                                                                      <TextBlock Text="ðŸ‘¤" HorizontalAlignment="Right" Foreground="#CCC"/>
                                                                  </Grid>
                                                             </Border>
                                                         </Grid>
                                                     </Border>
                                                 </ControlTemplate>
                                             </Button.Template>
                                         </Button>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>

                             <!-- Completed Section -->
                             <TextBlock Grid.Row="2" Text="ARCHIVES / TERMINÃ‰S" FontSize="14" FontWeight="Bold" Foreground="#999" Margin="0,0,0,15"/>
                             <ItemsControl x:Name="ProjectsListCompleted" Grid.Row="3">
                                 <ItemsControl.ItemsPanel>
                                     <ItemsPanelTemplate>
                                         <WrapPanel/>
                                     </ItemsPanelTemplate>
                                 </ItemsControl.ItemsPanel>
                                 <ItemsControl.ItemTemplate>
                                      <!-- Simple List Style for Archives -->
                                      <DataTemplate>
                                         <Button Click="OpenProject_Click" Tag="{Binding}" Background="White" BorderBrush="#EEE" BorderThickness="1" Margin="0,0,15,10" Width="400" HorizontalContentAlignment="Stretch" Cursor="Hand">
                                              <Border Padding="15,10">
                                                  <Grid>
                                                  <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="Auto"/>
                                                  </Grid.ColumnDefinitions>
                                                  <Border Background="#E8F5E9" CornerRadius="4" Padding="6,2" Margin="0,0,10,0">
                                                      <TextBlock Text="âœ“" Foreground="#2E7D32" FontWeight="Bold"/>
                                                  </Border>
                                                  <StackPanel Grid.Column="1">
                                                      <TextBlock Text="{Binding Title}" FontWeight="SemiBold"/>
                                                      <TextBlock Text="{Binding Institution}" FontSize="11" Foreground="#999"/>
                                                  </StackPanel>
                                                  <TextBlock Grid.Column="2" Text="{Binding CreatedOn, StringFormat='{}{0:yyyy}'}" Foreground="#CCC"/>
                                                  </Grid>
                                              </Border>
                                         </Button>
                                      </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>

                        </StackPanel>



                        <!-- Recent Projects Section -->
                        <Border Grid.Row="2" Background="White" CornerRadius="10" Padding="20" BorderBrush="#E0E0E0" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="Projets RÃ©cents" FontSize="18" FontWeight="Bold" Foreground="#333" Margin="0,0,0,15"/>
                                
                                <ListBox x:Name="RecentProjectsListBox" BorderThickness="0" Background="Transparent">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="Margin" Value="0,0,0,10"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ListBoxItem">
                                                        <Border Background="{TemplateBinding Background}" CornerRadius="5" BorderThickness="0">
                                                            <ContentPresenter/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="15" CornerRadius="8" Background="#FAFAFA" BorderBrush="#EEE" BorderThickness="1">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="50"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <!-- Icon -->
                                                    <Border Background="#E1F5FE" Width="40" Height="40" CornerRadius="20" HorizontalAlignment="Left">
                                                        <TextBlock Text="P" Foreground="#0277BD" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    
                                                    <!-- Info -->
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10,0,0,0">
                                                        <TextBlock Text="{Binding Title}" FontWeight="Bold" Foreground="#333" FontSize="14"/>
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding StudyType}" FontSize="12" Foreground="#888"/>
                                                            <TextBlock Text=" â€¢ " Foreground="#CCC" Margin="5,0"/>
                                                            <TextBlock Text="{Binding CreatedOn, StringFormat='{}{0:dd MMM yyyy}'}" FontSize="12" Foreground="#888"/>
                                                        </StackPanel>
                                                    </StackPanel>
                                                    
                                                    <!-- Actions -->
                                                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                                        <Button Content="Ouvrir" Click="OpenProject_Click" Background="Transparent" Foreground="{StaticResource PrimaryBrush}" BorderThickness="0" FontWeight="SemiBold" Cursor="Hand" Margin="0,0,10,0"/>
                                                        <Button Content="&#xE74D;" Click="DeleteProject_Click" FontFamily="Segoe MDL2 Assets" Background="Transparent" Foreground="#EF5350" BorderThickness="0" ToolTip="Supprimer" Cursor="Hand"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                                
                                <!-- Empty State (Visible if needed via binding, currently static placeholder text won't work easily without visibility converter on listbox count, skipping for simplicity) -->
                            </StackPanel>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- Nouveau Projet -->
            <TabItem x:Name="ViewNewProject">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Background="#F5F7F8">
                    <Border Margin="30" HorizontalAlignment="Stretch" Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Initialisation du Nouveau Projet" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,25"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Titre du projet" Style="{StaticResource LabelStyle}"/>
                                    <TextBox x:Name="TitleTextBox" Margin="0,5,0,20" Tag="Entrez le titre de votre projet de recherche ici..."/>
                                    <TextBlock Text="Contexte du Projet" Style="{StaticResource LabelStyle}"/>
                                    <ComboBox x:Name="ProjectContextComboBox" Height="40" Margin="0,5,0,20" Padding="10" VerticalContentAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <TextBlock Text="Institution / Organisme" Style="{StaticResource LabelStyle}"/>
                                    <TextBox x:Name="InstitutionTextBox" Margin="0,5,0,20" Tag="Ex: UniversitÃ© de Paris, HÃ´pital Central..."/>
                                    <TextBlock Text="Domaine Scientifique" Style="{StaticResource LabelStyle}"/>
                                    <ComboBox x:Name="DomainComboBox" Height="40" Margin="0,5,0,20" Padding="10" VerticalContentAlignment="Center">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <TextBlock Text="Type d'Ã©tude" Style="{StaticResource LabelStyle}"/>
                                    <ComboBox x:Name="StudyTypeComboBox" Height="40" Margin="0,5,0,20" Padding="10" VerticalContentAlignment="Center">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>
                            <TextBlock Text="Auteurs (sÃ©parÃ©s par des virgules)" Style="{StaticResource LabelStyle}"/>
                            <TextBox x:Name="AuthorsTextBox" Height="80" TextWrapping="Wrap" AcceptsReturn="True" Tag="Listez les auteurs (Nom PrÃ©nom), sÃ©parÃ©s par des virgules..."/>
                            
                            <!-- Location Selection -->
                            <TextBlock Text="Emplacement du Projet (Local)" Style="{StaticResource LabelStyle}" Margin="0,15,0,0"/>
                            <Grid Margin="0,5,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="ProjectPathTextBox" IsReadOnly="True" Background="#F1F1F1" Text="Documents/AdRev/Projects (DÃ©faut)" Padding="10" VerticalContentAlignment="Center" Height="40"/>
                                <Button Grid.Column="1" Content="..." Width="40" Height="40" Margin="10,0,0,0" Click="BrowseProjectFolder_Click" ToolTip="Choisir un dossier spÃ©cifique" Style="{StaticResource SecondaryButtonStyle}"/>
                            </Grid>

                            <Border Background="#FFE0B2" Padding="15" CornerRadius="8" Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="ðŸš€ AccÃ©lÃ©ration" FontWeight="Bold" Foreground="#BF360C" FontSize="12" Margin="0,0,0,5"/>
                                    <TextBlock Text="Vous avez dÃ©jÃ  un protocole validÃ© ?" FontSize="11" Foreground="#777" Margin="0,0,0,10"/>
                                    <Button Content="Convertir un Protocole en Projet" Style="{StaticResource SecondaryButtonStyle}" Background="#E65100" Foreground="White" Height="35"/>
                                </StackPanel>
                            </Border>

                            <Button Content="Valider et CrÃ©er le Projet" Click="CreateProject_Click" Height="50" Margin="0,5,0,0"/>
                            <TextBlock x:Name="ResultTextBlock" Margin="0,15,0,0" Foreground="{StaticResource PrimaryBrush}" FontWeight="SemiBold" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

                                <!-- TAB 6: BIBLIOTHÃˆQUE / PORTFOLIO -->
                <TabItem Header="Ma BibliothÃ¨que">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Header -->
                            <RowDefinition Height="Auto"/> <!-- Filters -->
                            <RowDefinition Height="*"/>    <!-- DataGrid -->
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Portfolio de Publications" FontWeight="Bold" FontSize="18" Foreground="{StaticResource PrimaryBrush}"/>
                                <TextBlock Text="Suivi des rapports validÃ©s et articles publiÃ©s." FontSize="12" Foreground="#666" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Filters -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="Filtrer :" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                            <ComboBox x:Name="LibraryStatusFilter" Width="150" Height="30" SelectedIndex="0" SelectionChanged="LibraryFilter_Changed" Margin="0,0,10,0">
                                <ComboBoxItem Content="Tous les Statuts"/>
                                <ComboBoxItem Content="PubliÃ©"/>
                                <ComboBoxItem Content="AcceptÃ© / ValidÃ©"/>
                                <ComboBoxItem Content="TerminÃ©"/>
                            </ComboBox>
                            <Button Content="Actualiser" Width="100" Height="30" Click="BtnRefreshLibrary_Click" Style="{StaticResource ModernButtonStyle}"/>
                        </StackPanel>

                        <!-- DataGrid -->
                        <DataGrid x:Name="LibraryGrid" Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True" 
                                  HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                  BorderThickness="1" BorderBrush="#E0E0E0" Background="White">
                            <DataGrid.Resources>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Height" Value="35"/>
                                    <Setter Property="Padding" Value="10,0"/>
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                </Style>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Padding" Value="10"/>
                                    <Setter Property="Block.TextAlignment" Value="Center"/>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date" Binding="{Binding CreatedOn, StringFormat=d}" Width="100"/>
                                <DataGridTextColumn Header="Titre du Projet" Binding="{Binding Title}" Width="*"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding AcademicLevel}" Width="150"/>
                                <DataGridTextColumn Header="Revue / Cible" Binding="{Binding TargetJournalName}" Width="150"/>
                                <DataGridTextColumn Header="Rang" Binding="{Binding AuthorRank}" Width="60"/>
                                <DataGridTemplateColumn Header="Statut" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{StaticResource PrimaryBrush}" CornerRadius="4" Padding="8,4">
                                                <TextBlock Text="{Binding Status}" Foreground="White" HorizontalAlignment="Center" FontSize="11"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Actions" Width="140">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="âœ”" ToolTip="Marquer comme AcceptÃ©" Click="LibraryMarkAccepted_Click" Width="30" Margin="0,0,5,0" Style="{StaticResource SecondaryButtonStyle}" FontSize="12"/>
                                                <Button Content="ðŸ“¢" ToolTip="Marquer comme PubliÃ©" Click="LibraryMarkPublished_Click" Width="30" Margin="0,0,5,0" Style="{StaticResource SecondaryButtonStyle}" FontSize="12"/>
                                                <Button Content="ðŸ“‚" ToolTip="Ouvrir le Projet" Click="BtnOpenProjectLibrary_Click" Width="30" Style="{StaticResource SecondaryButtonStyle}" FontSize="12"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>
            <TabItem x:Name="ViewHelp">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="30" Background="#F5F7F8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Margin="0,0,0,30">
                            <TextBlock Text="Centre d'Aide &amp; Ressources" FontSize="28" FontWeight="Bold" Foreground="#333"/>
                            <TextBlock Text="Tout ce dont vous avez besoin pour maÃ®triser AdRev." Foreground="#666" FontSize="16"/>
                        </StackPanel>

                        <WrapPanel Grid.Row="1" HorizontalAlignment="Center">
                            <!-- Card 1: Documentation -->
                            <Button Tag="Documentation" Click="HelpAction_Click" Margin="20" Background="Transparent" BorderThickness="0" Padding="0">
                                <Border Width="260" Height="280" Background="White" CornerRadius="12" BorderBrush="#E0E0E0" BorderThickness="1">
                                    <Border.Effect><DropShadowEffect BlurRadius="12" Color="#DDD" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="140"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Border Background="#E3F2FD" CornerRadius="12,12,0,0" Padding="25">
                                            <Image Source="Assets/help_doc.png" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel Grid.Row="1" Margin="20" VerticalAlignment="Center">
                                            <TextBlock Text="Documentation" FontWeight="Bold" FontSize="18" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                            <TextBlock Text="Guides utilisateurs complets." Foreground="#666" FontSize="13" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Button>

                            <!-- Card 2: Tutorials -->
                             <Button Tag="Tutorials" Click="HelpAction_Click" Margin="20" Background="Transparent" BorderThickness="0" Padding="0">
                                <Border Width="260" Height="280" Background="White" CornerRadius="12" BorderBrush="#E0E0E0" BorderThickness="1">
                                    <Border.Effect><DropShadowEffect BlurRadius="12" Color="#DDD" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="140"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Border Background="#E8F5E9" CornerRadius="12,12,0,0" Padding="25">
                                            <Image Source="Assets/help_tutorial.png" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel Grid.Row="1" Margin="20" VerticalAlignment="Center">
                                            <TextBlock Text="Tutoriels VidÃ©o" FontWeight="Bold" FontSize="18" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                            <TextBlock Text="Apprenez en regardant." Foreground="#666" FontSize="13" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Button>

                            <!-- Card 3: Support -->
                             <Button Tag="Support" Click="HelpAction_Click" Margin="20" Background="Transparent" BorderThickness="0" Padding="0">
                                <Border Width="260" Height="280" Background="White" CornerRadius="12" BorderBrush="#E0E0E0" BorderThickness="1">
                                    <Border.Effect><DropShadowEffect BlurRadius="12" Color="#DDD" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="140"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Border Background="#FFE0B2" CornerRadius="12,12,0,0" Padding="25">
                                            <Image Source="Assets/help_support.png" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel Grid.Row="1" Margin="20" VerticalAlignment="Center">
                                            <TextBlock Text="Support Technique" FontWeight="Bold" FontSize="18" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                            <TextBlock Text="Une question ? Contactez-nous." Foreground="#666" FontSize="13" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Button>

                             <!-- Card 4: Subscription (NEW) -->
                             <Button Tag="Subscription" Click="HelpAction_Click" Margin="20" Background="Transparent" BorderThickness="0" Padding="0">
                                 <Border Width="260" Height="280" Background="White" CornerRadius="12" BorderBrush="#E0E0E0" BorderThickness="1">
                                     <Border.Effect><DropShadowEffect BlurRadius="12" Color="#DDD" Opacity="0.4" ShadowDepth="4"/></Border.Effect>
                                     <Grid>
                                         <Grid.RowDefinitions>
                                             <RowDefinition Height="140"/>
                                             <RowDefinition Height="*"/>
                                         </Grid.RowDefinitions>
                                         <Border Background="#F3E5F5" CornerRadius="12,12,0,0" Padding="25">
                                             <Image Source="Assets/help_license.png" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                         </Border>
                                         <StackPanel Grid.Row="1" Margin="20" VerticalAlignment="Center">
                                             <TextBlock Text="Abonnement" FontWeight="Bold" FontSize="18" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                             <TextBlock Text="GÃ©rez votre licence Pro / USB." Foreground="#666" FontSize="13" HorizontalAlignment="Center"/>
                                         </StackPanel>
                                     </Grid>
                                 </Border>
                             </Button>
                        </WrapPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- 4. STATUS BAR -->
        <Border Grid.Row="3" Background="{StaticResource PrimaryDarkBrush}" Padding="15,0">
            <Grid>
                <TextBlock Text="PrÃªt" Foreground="White" FontSize="11" VerticalAlignment="Center"/>
                <TextBlock Text="AdRev Science Suite v1.0.0 (First Edition) | Â© 2024-2026 AdRev Team" Foreground="White" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
            </Grid>
        </Border>
    </Grid>
    </Border>
</Window>

