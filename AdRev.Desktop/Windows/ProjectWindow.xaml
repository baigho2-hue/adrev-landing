<Window x:Class="AdRev.Desktop.Windows.ProjectWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AdRev.Desktop"
        xmlns:win="clr-namespace:AdRev.Desktop.Windows"
        xmlns:project="clr-namespace:AdRev.Desktop.Views.Project"
        mc:Ignorable="d"
        Title="AdRev Project" Height="700" Width="1100"
        MinHeight="600" MinWidth="1000"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" ResizeBorderThickness="8" CornerRadius="0" GlassFrameThickness="0"/>
    </WindowChrome.WindowChrome>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Title Bar -->
            <RowDefinition Height="Auto"/> <!-- Progress Stepper -->
            <RowDefinition Height="Auto"/> <!-- Ribbon -->
            <RowDefinition Height="*"/>    <!-- Content -->
            <RowDefinition Height="25"/>   <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- 1. TOP TITLE BAR -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryDarkBrush}" Padding="10,5,10,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,30,5" WindowChrome.IsHitTestVisibleInChrome="True">
                     <TextBlock Text="AdRev Project" Foreground="White" FontSize="16" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                     <TextBlock x:Name="TxtProjectTitleHeader" Text="Project Name" Foreground="#B0BEC5" FontSize="14" VerticalAlignment="Center" FontStyle="Italic"/>
                </StackPanel>

                <!-- Project Quick Actions -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                     <Button Content="&#xE74E;" Click="QuickSave_Click" ToolTip="Enregistrer" Background="Transparent" Foreground="#E0E0E0" BorderThickness="0" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,5,0" Padding="5"/>
                </StackPanel>

                <!-- Window Controls -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Top" Margin="0,-5,-10,0">
                    <Button Style="{StaticResource WindowControlButtonStyle}" Content="&#xE921;" Click="Minimize_Click" ToolTip="Réduire"/>
                    <Button Style="{StaticResource WindowControlButtonStyle}" Content="&#xE922;" Click="Maximize_Click" ToolTip="Agrandir/Restaurer"/>
                    <Button Style="{StaticResource CloseButtonStyle}" Content="&#xE8BB;" Click="Close_Click" ToolTip="Fermer"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 2. PROGRESS STEPPER -->
        <Border Grid.Row="1" Background="White" BorderBrush="#DDD" BorderThickness="0,0,0,1" Padding="20,10">
            <Grid HorizontalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/> <!-- Protocol -->
                    <ColumnDefinition Width="60"/>   <!-- Line -->
                    <ColumnDefinition Width="Auto"/> <!-- Variables -->
                    <ColumnDefinition Width="60"/>   <!-- Line -->
                    <ColumnDefinition Width="Auto"/> <!-- Data -->
                    <ColumnDefinition Width="60"/>   <!-- Line -->
                    <ColumnDefinition Width="Auto"/> <!-- Analysis -->
                    <ColumnDefinition Width="60"/>   <!-- Line -->
                    <ColumnDefinition Width="Auto"/> <!-- Report -->
                </Grid.ColumnDefinitions>

                <!-- Protocol Step -->
                <StackPanel x:Name="StepProtocol" Grid.Column="0" Opacity="1">
                    <Ellipse Width="24" Height="24" Fill="{StaticResource PrimaryBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="1" Foreground="White" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" Margin="0,-22,0,0"/>
                    <TextBlock Text="PROTOCOLE" FontSize="10" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                <Rectangle Grid.Column="1" Height="2" Fill="#EEE" VerticalAlignment="Center" Margin="5,0,5,20"/>

                <!-- Variables Step -->
                <StackPanel x:Name="StepVariables" Grid.Column="2" Opacity="0.4">
                    <Ellipse Width="24" Height="24" Fill="#CCC" HorizontalAlignment="Center"/>
                    <TextBlock Text="2" Foreground="White" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" Margin="0,-22,0,0"/>
                    <TextBlock Text="VARIABLES" FontSize="10" FontWeight="Bold" Foreground="#888" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                <Rectangle Grid.Column="3" Height="2" Fill="#EEE" VerticalAlignment="Center" Margin="5,0,5,20"/>

                <!-- Data Step -->
                <StackPanel x:Name="StepData" Grid.Column="4" Opacity="0.4">
                    <Ellipse Width="24" Height="24" Fill="#CCC" HorizontalAlignment="Center"/>
                    <TextBlock Text="3" Foreground="White" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" Margin="0,-22,0,0"/>
                    <TextBlock Text="COLLECTE" FontSize="10" FontWeight="Bold" Foreground="#888" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                <Rectangle Grid.Column="5" Height="2" Fill="#EEE" VerticalAlignment="Center" Margin="5,0,5,20"/>

                <!-- Analysis Step -->
                <StackPanel x:Name="StepAnalysis" Grid.Column="6" Opacity="0.4">
                    <Ellipse Width="24" Height="24" Fill="#CCC" HorizontalAlignment="Center"/>
                    <TextBlock Text="4" Foreground="White" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" Margin="0,-22,0,0"/>
                    <TextBlock Text="ANALYSE" FontSize="10" FontWeight="Bold" Foreground="#888" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                <Rectangle Grid.Column="7" Height="2" Fill="#EEE" VerticalAlignment="Center" Margin="5,0,5,20"/>

                <!-- Report Step -->
                <StackPanel x:Name="StepReport" Grid.Column="8" Opacity="0.4">
                    <Ellipse Width="24" Height="24" Fill="#CCC" HorizontalAlignment="Center"/>
                    <TextBlock Text="5" Foreground="White" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" Margin="0,-22,0,0"/>
                    <TextBlock Text="PUBLICATION" FontSize="10" FontWeight="Bold" Foreground="#888" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 3. RIBBON FOR PROJECT (Simplified or Moved from MainWindow) -->
        <Border Grid.Row="2" Background="{StaticResource MenuBarBrush}" BorderBrush="#DDD" BorderThickness="0,0,0,1" Padding="12,5">
            <StackPanel Orientation="Horizontal" Height="50">
                 <!-- Tabs will control the content below -->
                <RadioButton x:Name="RibbonStep1" Style="{StaticResource RibbonTabButtonStyle}" Content="Protocole" IsChecked="True" Checked="Ribbon_Checked" Tag="0"/>
                <RadioButton x:Name="RibbonStep2" Style="{StaticResource RibbonTabButtonStyle}" Content="Variables" Checked="Ribbon_Checked" Tag="1"/>
                <RadioButton x:Name="RibbonStep3" Style="{StaticResource RibbonTabButtonStyle}" Content="Saisie" Checked="Ribbon_Checked" Tag="2"/>
                <RadioButton x:Name="RibbonStep4" Style="{StaticResource RibbonTabButtonStyle}" Content="Stats" Checked="Ribbon_Checked" Tag="3"/>
                <RadioButton x:Name="RibbonStep5" Style="{StaticResource RibbonTabButtonStyle}" Content="Quali Dashboard" Checked="Ribbon_Checked" Tag="4"/>
                <RadioButton x:Name="RibbonStep5b" Style="{StaticResource RibbonTabButtonStyle}" Content="Atelier Codage" Checked="Ribbon_Checked" Tag="5"/>
                <RadioButton x:Name="RibbonStep6" Style="{StaticResource RibbonTabButtonStyle}" Content="Discussion" Checked="Ribbon_Checked" Tag="6"/>
                <RadioButton x:Name="RibbonStep7" Style="{StaticResource RibbonTabButtonStyle}" Content="Rapport" Checked="Ribbon_Checked" Tag="7"/>
                <RadioButton x:Name="RibbonStep8" Style="{StaticResource RibbonTabButtonStyle}" Content="Article" Checked="Ribbon_Checked" Tag="8"/>
                <RadioButton x:Name="RibbonStep9" Style="{StaticResource RibbonTabButtonStyle}" Content="Qualité" Checked="Ribbon_Checked" Tag="9"/>
            </StackPanel>
        </Border>

        <!-- 4. PROJECT CONTENT TABS -->
        <TabControl x:Name="ProjectTabControl" Grid.Row="3" Background="Transparent" BorderThickness="0" Margin="0,-1,0,0">
            <TabControl.Template>
                <ControlTemplate TargetType="TabControl">
                    <ContentPresenter ContentSource="SelectedContent" />
                </ControlTemplate>
            </TabControl.Template>

            <TabItem x:Name="TabProtocol">
                <project:ProtocolView x:Name="ViewProtocol"/>
            </TabItem>
            <TabItem x:Name="TabVariables">
                <project:VariableDesignView x:Name="ViewVariableDesign"/>
            </TabItem>
            <TabItem x:Name="TabDataEntry">
                <project:DataEntryView x:Name="ViewDataEntry"/>
            </TabItem>
            <TabItem x:Name="TabAnalysis">
                <project:AnalysisView x:Name="ViewAnalysis"/>
            </TabItem>
            <TabItem x:Name="TabQualitativeAnalysis">
                <project:QualitativeAnalysisView x:Name="ViewQualitativeAnalysis"/>
            </TabItem>
            <TabItem x:Name="TabQualitativeCoding">
                <project:QualitativeCodingView x:Name="ViewQualitativeCoding"/>
            </TabItem>
            <TabItem x:Name="TabDiscussion">
                <project:DiscussionView x:Name="ViewDiscussion"/>
            </TabItem>
            <TabItem x:Name="TabFinalReport">
                <project:FinalReportView x:Name="ViewFinalReport"/>
            </TabItem>
            <TabItem x:Name="TabJournal">
                <project:JournalArticleView x:Name="ViewJournalArticle"/>
            </TabItem>
            <TabItem x:Name="TabQuality">
                <project:QualityCheckView x:Name="ViewQualityCheck"/>
            </TabItem>
        </TabControl>

        <!-- 5. STATUS BAR -->
        <StatusBar Grid.Row="4" Background="#F0F4F8">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Statut du Projet :" Foreground="#555" Margin="0,0,5,0"/>
                    <TextBlock x:Name="StatusBarProjectStatus" Text="En cours" FontWeight="SemiBold" Foreground="{StaticResource PrimaryBrush}"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="StatusBarLastSaved" Text="Dernière sauvegarde : Jamais" Foreground="#888"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
